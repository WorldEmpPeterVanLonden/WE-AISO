# apphosting.yaml

# De build-instellingen voor het Next.js (of Node.js) project
build:
  # Gebruik de Next.js build tool voor de Next.js adapter
  builder: next

# De runtime-instellingen
run:
  # De Node.js versie die de server zal gebruiken
  runtime: "nodejs20" 
  
  # De hoeveelheid geheugen die de server toegewezen krijgt (pas aan indien nodig)
  # memory: 512Mi

# De omgevingsvariabelen en geheimen (secrets)
env:
  # === FIREBASE PUBLIC CONFIG ===
  # Deze variabelen zijn nodig voor de client-side Firebase SDK (NEXT_PUBLIC_*)
  - variable: NEXT_PUBLIC_FIREBASE_API_KEY
    secret: Portal-FIREBASE_API_KEY
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
    secret: Portal-FIREBASE_AUTH_DOMAIN
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
    secret: Portal-FIREBASE_PROJECT_ID
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
    secret: Portal-FIREBASE_STORAGE_BUCKET
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID
    secret: Portal-FIREBASE_MESSAGING_SENDER_ID
    availability: [BUILD, RUNTIME]
  - variable: NEXT_PUBLIC_FIREBASE_APP_ID
    secret: Portal-FIREBASE_APP_ID
    availability: [BUILD, RUNTIME]

  # === BASE URL ===
  - variable: NEXT_PUBLIC_BASE_URL
    value: "https://crm.worldemp.com"
    availability: [BUILD, RUNTIME]

  # === GOOGLE MAPS ===
  - variable: NEXT_PUBLIC_GOOGLE_MAPS_API_KEY
    value: "AIzaSyDa-3QEpmgp-Pqot-iTrCD6UTcUXCtBg7I"
    availability: [BUILD, RUNTIME]
  - variable: GOOGLE_MAPS_API_KEY
    value: "AIzaSyBn2lceGbX408vuB8slmPKKe_HG21JBS5w"
    availability: [BUILD, RUNTIME]
  
  # === VERTEX AI / GENKIT (PROD) ===
  # Dit is de configuratie voor de dual-provider logica in PROD
  - variable: VERTEX_PROJECT
    secret: Portal-FIREBASE_PROJECT_ID
    availability: [BUILD, RUNTIME]
  - variable: VERTEX_LOCATION
    value: "europe-west4"
    availability: [BUILD, RUNTIME]
  - variable: VERTEX_MODEL
    value: "gemini-1.5-flash-001"
    availability: [BUILD, RUNTIME]

  # ✅ NIEUW: De schakelaar voor de PROD-modus
  - variable: USE_VERTEX_AI
    value: "true"
    availability: [BUILD, RUNTIME]

  # ✅ NIEUW (OPTIONEEL): Google AI API Key als back-up/DEV secret
  - variable: GOOGLE_API_KEY
    secret: GOOGLE_API_KEY # Vervang door de naam van je secret
    availability: [RUNTIME]

  # === AUTH / SSO ===
  - variable: JWT_SECRET_KEY
    secret: JWT_SECRET_KEY
    availability: [RUNTIME]

  - variable: REQUIRED_APPLICATION_ID
    value: "66qwnQrS7yARKcqukFcv"
    availability: [RUNTIME]

  - variable: DISABLE_SSO
    value: "0"
    availability: [RUNTIME]

  # === FIREBASE ADMIN SERVICE ACCOUNT ===
  - variable: FIREBASE_SERVICE_ACCOUNT
    secret: SERVICE_ACCOUNT_JSON_SECRET
    availability: [BUILD, RUNTIME]

  # === OTEL DISABLE ===
  - variable: OTEL_SDK_DISABLED
    value: "true"
    availability: [RUNTIME]
  - variable: OTEL_TRACES_EXPORTER
    value: "none"
    availability: [RUNTIME]
